Pravila mogu biti:
- statefull - sa memorijom, pamte stanje
- stateless - bez memorije, ne pamte stanje

Sva pravila iz [v7](../v7/v7.md) su bila stateless.

`iptables -P FORWARD DROP`

`iptables -A FORWARD -o eth2 -j ACCEPT`

`nc -l -u -p 10000` - five

`nc five 10000 -u` - one

`iptables -A FORWARD -i eth2 -m state --state ESTABLISHED -j ACCEPT`

`-m` - modul

`nc -l -u -p 10000` - five

`nc five 9000 -u` - one 

Ne prolaze ICMP poruke.

`iptables -L --line-numbers`

`iptables -D FORWARD 2`

`iptables -A FORWARD -i eth2 -m state --state ESTABLISHED,RELATED -j ACCEPT`

Prolaze ICMP poruke.

---

`iptables -F`

`iptables -P FORWARD ACCEPT`

# NAT

DNAT - PREROUTING \
SNAT - POSTROUTING

`iptables -t nat -A POSTROUTING -i eth2 -j MASQUERADE`

`python server.py` - five
`nc five 10000` - one,three

`iptables -t nat -A PREROUTING -i eth2 -p udp --dport 8000 -j DNAT --to-destination 10.0.1.5:11000`

`nc -l -u 11000` - one

`nc 10.1.0.1 11000 -u` - five


## Ostalo
Fajl `/etc/fw.sh` u `router1`:
``` bash
iptables -t nat -A POSTROUTING -o eth2 -j MASQUERADE
iptables -A FORWARD -i eth2 -o eth1 -m state --state RELATED,ESTABLISHED -j ACCEPT
iptables -A FORWARD -i eth1 -o eth2 -j ACCEPT
iptables -A FORWARD -i eth2 -o eth0 -m state --state RELATED,ESTABLISHED -j ACCEPT
iptables -A FORWARD -i eth0 -o eth2 -j ACCEPT
iptables -A FORWARD -i eth1 -o eth0 -j ACCEPT
iptables -A FORWARD -i eth0 -o eth1 -j ACCEPT
iptables -A FORWARD -d 10.0.1.5 -j DROP
iptables -P FORWARD DROP
```
